/*!
 * angular-schema-form-material
 * @version 1.0.0-alpha.3
 * @date Wed, 29 Nov 2017 03:30:33 GMT
 * @link https://github.com/json-schema-form/angular-schema-form-material
 * @license MIT
 * Copyright (c) 2014-2017 JSON Schema Form
 */
!function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=29)}([function(e,t){var r="/material/default.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,"<md-input-container ng-class=\"['schema-form-' + form.type, form.htmlClass, {'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false}]\" sf-messages sf-layout sf-material-class=md-input-has-value> <label ng-show=showTitle() for={{::form.key|sfCamelKey}}>{{::form.title}}</label> <input sf-field-model ng-show=::form.key type={{::form.type}} step=any sf-changed=form placeholder={{::form.placeholder}} id={{::form.key|sfCamelKey}} ng-class=::form.fieldHtmlClass sf-type-parser=form.schema ng-disabled=::form.readonly schema-validate=form name={{::form.key|sfCamelKey}} aria-describedby={{::form.key|sfCamelKey}}Status /> <div ng-class=::form.hintClass ng-if=::form.hint.length>{{::form.hint}}</div> </md-input-container>")}]),e.exports=r},function(e,t){var r="/material/checkbox.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,"<div class=\"checkbox schema-form-checkbox {{::form.htmlClass}}\" ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess()}\" sf-messages> <md-checkbox sf-field-model sf-changed=form ng-disabled=form.readonly schema-validate=form sf-material-class=md-checked class={{::form.fieldHtmlClass}} name={{::form.key|sfCamelKey}} aria-label={{::form.title}}> <span>{{::form.title}}</span> </md-checkbox> </div>")}]),e.exports=r},function(e,t){var r="/material/submit.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<section class="schema-form-submit {{::form.htmlClass}}" sf-messages> <md-button class="md-raised {{ form.style || \'md-primary\' }} {{::form.fieldHtmlClass}}" type={{::form.type}} ng-disabled=form.readonly aria-label={{::form.title}}> <md-tooltip ng-if=::form.tip>{{::form.tip}}</md-tooltip> {{::form.title}} </md-button> </section>')}]),e.exports=r},function(e,t,r){r(22),r(21),r(20)},function(e,t){var r="/material/actions.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<section layout=row class="btn-group schema-form-actions {{form.htmlClass}}"></section>')}]),e.exports=r},function(e,t){var r="/material/array.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="schema-form-array {{::form.htmlClass}}" sf-field-model=sf-new-array sf-new-array> <label class=control-label ng-show=showTitle()>{{ form.title }}</label> <md-list class=list-group sf-field-model ui-sortable=form.sortOptions> <md-list-item layout=row class=list-group-item sf-field-model=ng-repeat ng-repeat="item in modelArray track by $index" schema-form-array-items class={{::form.fieldHtmlClass}}> <md-button flex=none flex-order=2 type=button ng-hide="form.readonly || form.remove === null" ng-click=deleteFromArray($index) ng-disabled="form.schema.minItems >= modelArray.length" class=md-icon-button aria-label=More style=position:relative;z-index:20> <md-icon>close</md-icon> </md-button> </md-list-item> </md-list> <div class=clearfix style=padding:15px ng-model=modelArray schema-validate=form> <div class=help-block ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div> <md-button ng-hide="form.readonly || form.add === null" ng-click=appendToArray() ng-disabled="form.schema.maxItems <= modelArray.length" type=button class="btn md-raised md-primary {{ form.style.add || \'btn-default\' }} pull-right"> <i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}} </md-button> </div> </div>')}]),e.exports=r},function(e,t){var r="/material/autocomplete.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,"<div class=\"form-group {{::form.htmlClass}} schema-form-select\" ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false}\" sf-messages sf-layout> <md-autocomplete flex ng-disabled=form.readonly ng-model=$$value$$ sf-autocomplete sf-field-model=replaceAll schema-validate=form md-selected-item=$$value$$ md-search-text=searchText md-selected-item-change=\"'todo';\" md-items=\"item in evalExpr('this[\\''+form.optionFilter+'\\'](\\''+searchText+'\\')')\" md-item-text=item.name md-floating-label={{::form.title}} md-menu-class=autocomplete-custom-template> <md-item-template> <span md-highlight-text=searchText>{{item.name}}</span> </md-item-template> <md-not-found> No matches found </md-not-found> </md-autocomplete> </div>")}]),e.exports=r},function(e,t){var r="/material/checkboxes.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div sf-array=form sf-field-model class="form-group schema-form-checkboxes {{::form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}" sf-messages> <label class=control-label ng-show=showTitle()>{{::form.title}}</label> <div class=checkboxes sf-layout> <div class=checkbox ng-repeat="val in titleMapValues track by $index"> <md-checkbox ng-model=titleMapValues[$index] sf-changed=form ng-disabled="::form.readonly || form.titleMap[$index].readonly" ng-class=::form.fieldHtmlClass name={{::form.key|sfCamelKey}} ng-true-value=true ng-false-value=false aria-label={{::form.title}}> {{::form.titleMap[$index].name}} </md-checkbox> </div> </div> </div>')}]),e.exports=r},function(e,t){var r="/material/date.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="schema-form-date {{::form.htmlClass}}"> <label ng-show=showTitle() for={{::form.key|sfCamelKey}}>{{::form.title}}</label> <md-datepicker sf-field-model sf-changed=form schema-validate=form sf-type-parser=form.schema id={{::form.key|sfCamelKey}} ng-show=::form.key ng-class=::form.fieldHtmlClass ng-disabled=::form.readonly md-placeholder="Enter date" sf-messages> </md-datepicker> </div>')}]),e.exports=r},function(e,t){var r="/material/fieldset.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<fieldset ng-disabled=form.readonly class="standard {{form.htmlClass}}" flex> <legend ng-show=form.title>{{ form.title }}</legend> </fieldset>')}]),e.exports=r},function(e,t){var r="/material/help.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,"<div ng-class=\"['helpvalue', 'schema-form-helpvalue', form.htmlClass]\" ng-bind-html=form.helpvalue sf-layout></div>")}]),e.exports=r},function(e,t){var r="/material/radio-buttons.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="form-group schema-form-radiobuttons {{::form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}" sf-layout sf-messages> <div> <label class=control-label ng-show=showTitle()>{{form.title}}</label> </div> <section layout=row layout-sm=column layout-align="center center"> <md-input-container ng-repeat="item in form.titleMap"> <md-button type=button class="group md-raised" sf-field-model=replaceAll ng-model=$$value$$ sf-changed=form class="radio {{::form.fieldHtmlClass}}" ng-class="{\'md-primary\': ($$value$$ == item.value)}" ng-disabled=form.readonly ng-model-options=form.ngModelOptions schema-validate=form ng-value=item.value ng-click="$$value$$ = item.value" name="{{form.key.join(\'.\')}}"> <span ng-bind-html=item.name></span> </md-button> </md-input-container> </section> </div>')}]),e.exports=r},function(e,t){var r="/material/radios-inline.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="form-group schema-form-radios-inline {{::form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}" sf-layout sf-messages> <label class=control-label ng-show=showTitle()>{{form.title}}</label> <md-radio-group layout=row sf-field-model=replaceAll ng-model=$$value$$ ng-class="[form.fieldHtmlClass, { active: item.value === $$value$$ }]" sf-changed=form schema-validate=form ng-disabled=form.readonly id="{{form.key.join(\'.\')}}" name="{{form.key.join(\'.\')}}"> <md-radio-button ng-repeat="item in form.titleMap" ng-value=item.value aria-label=item.name> <span ng-bind-html=item.name></span> </md-radio-button> </md-radio-group> </div>')}]),e.exports=r},function(e,t){var r="/material/radios.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div class="form-group schema-form-radios {{::form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"> <label class=control-label ng-show=showTitle() aria-label={{form.title}} layout=row>{{form.title}}</label> <div> <md-radio-group sf-field-model sf-changed=form schema-validate=form ng-disabled=form.readonly id="{{form.key.join(\'.\')}}" name="{{form.key.join(\'.\')}}" sf-layout sf-messages> <md-radio-button ng-repeat="item in form.titleMap" ng-value=item.value class={{::form.fieldHtmlClass}} sf-field-model=ng-class aria-label=item.name ng-class="{ active: item.value === $$value$$ }"> <span ng-bind-html=item.name></span> </md-radio-button> </md-radio-group> </div> </div>')}]),e.exports=r},function(e,t){var r="/material/section.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<md-content class="schema-form-section {{::form.htmlClass}}" sf-layout> </md-content>')}]),e.exports=r},function(e,t){var r="/material/select.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,"<md-input-container class=\"form-group {{::form.htmlClass}} schema-form-select\" ng-class=\"{'has-error': hasError(), 'has-success': hasSuccess(), 'has-feedback': form.feedback !== false}\" sf-messages sf-layout> <label ng-show=::showTitle()>{{::form.title}}</label> <md-select sf-field-model sf-changed=form schema-validate=form ng-disabled=form.readonly> <md-optgroup ng-repeat-start=\"(key, opt) in form.titleMap | orderBy:'group' as optGroups\" ng-if=\"opt.group && opt.group != optGroups[key-1].group\" label={{::opt.group}} aria-label={{::opt.group}}> <md-option ng-repeat=\"(key, filtered) in form.titleMap | filter: {group: opt.group} | orderBy:'name' as opts\" ng-value=::filtered.value aria-label={{::filtered.name}}>{{::filtered.name}}</md-option> </md-optgroup> <md-option ng-if=!opt.group ng-value=::opt.value ng-repeat-end>{{::opt.name}}</md-option> </md-select> </md-input-container>")}]),e.exports=r},function(e,t){var r="/material/switch.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<md-input-container class="schema-form-switch {{::form.htmlClass}}"> <md-switch sf-field-model sf-changed=form sf-type-parser=form.schema sf-messages schema-validate=form id={{::form.key|sfCamelKey}} aria-label={{form.title}} ng-show=::form.key ng-class=form.fieldHtmlClass ng-disabled=::form.readonly> <span ng-show=showTitle() for={{::form.key|sfCamelKey}}>{{::form.title}}</span> </md-switch> </md-input-container>')}]),e.exports=r},function(e,t){var r="/material/tabarray.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div sf-array=form ng-init="selected = { tab: 0 }" class="clearfix schema-form-tabarray schema-form-tabarray-{{form.tabType || \'left\'}} {{::form.htmlClass}}"> <div ng-if="!form.tabType || form.tabType !== \'right\'" ng-class="{\'col-xs-3\': !form.tabType || form.tabType === \'left\'}"> <ul class="nav nav-tabs" ng-class="{ \'tabs-left\': !form.tabType || form.tabType === \'left\'}"> <li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"> <a href=#>{{interp(form.title,{\'$index\':$index, value: item}) || $index}}</a> </li> <li ng-hide=form.readonly ng-click="$event.preventDefault() || (selected.tab = appendToArray().length - 1)"> <a href=#> <i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}} </a> </li> </ul> </div> <div ng-class="{\'col-xs-9\': !form.tabType || form.tabType === \'left\' || form.tabType === \'right\'}"> <div class="tab-content {{::form.fieldHtmlClass}}"> <div class="tab-pane clearfix" ng-repeat="item in modelArray track by $index" ng-show="selected.tab === $index" ng-class="{active: selected.tab === $index}"> <sf-decorator ng-init="arrayIndex = $index" form=copyWithIndex($index)></sf-decorator> <button ng-hide=form.readonly ng-click="selected.tab = deleteFromArray($index).length - 1" type=button class="btn {{ form.style.remove || \'btn-default\' }} pull-right"> <i class="glyphicon glyphicon-trash"></i> {{ form.remove || \'Remove\'}} </button> </div> </div> </div> <div ng-if="form.tabType === \'right\'" class=col-xs-3> <ul class="nav nav-tabs tabs-right"> <li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"> <a href=#>{{interp(form.title,{\'$index\':$index, value: item}) || $index}}</a> </li> <li ng-hide=form.readonly ng-click="$event.preventDefault() || appendToArray()"> <a href=#> <i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}} </a> </li> </ul> </div> </div>')}]),e.exports=r},function(e,t){var r="/material/tabs.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<div sf-field-model class="schema-form-tabs {{::form.htmlClass}}"> <md-tabs md-dynamic-height md-selected=selected md-autoselect ng-init="selected = 0"></md-tabs> </div>')}]),e.exports=r},function(e,t){var r="/material/textarea.html";window.angular.module("ng").run(["$templateCache",function(e){e.put(r,'<md-input-container class="{{::form.htmlClass}} schema-form-textarea" sf-messages sf-layout> <label ng-show=showTitle() for={{::form.key|sfCamelKey}}>{{::form.title}}</label> <textarea ng-class=::form.fieldHtmlClass id={{::form.key|sfCamelKey}} sf-changed=form ng-disabled=::form.readonly sf-field-model schema-validate=form name={{::form.key|sfCamelKey}}></textarea> </md-input-container>')}]),e.exports=r},function(e,t){function r(e,t){return{restrict:"A",scope:!1,link:function(e,r,a,n){function o(e,t){return e[t]}var i;try{i=e.form.key.reduce(o,e.model)}catch(e){i=void 0}t(function(){null!==i&&void 0!==i&&!1!==i&&r.addClass(a.sfMaterialClass)},0)}}}angular.module("schemaForm").directive("sfMaterialClass",r),r.$inject=["$compile","$timeout"]},function(e,t,r){"use strict";function a(e,t,r,a,i){function l(e){var t=e.fieldFrag.querySelector("[sf-layout]");e.form.grid&&Object.getOwnPropertyNames(e.form.grid).forEach(function(r,a,n){t.setAttribute(r,e.form.grid[r])})}function s(e){var t=e.fieldFrag.querySelector("[sf-messages]");if(t&&I){var r=I.cloneNode();t.appendChild(r)}}function m(e){var t=e.fieldFrag.querySelector("textarea"),r=e.form.maxlength||!1;t&&r&&t.setAttribute("md-maxlength",r)}function f(e){var t=e.fieldFrag.querySelector("md-autocomplete"),r=e.form.minLength||1,a=e.form.maxLength||!1,n=e.form.title||e.form.placeholder||e.form.key.slice(-1)[0];t&&(e.form.onChange&&(t.setAttribute("md-selected-item-change","args.form.onChange()"),t.setAttribute("md-search-text-change","args.form.onChange(searchText)")),t.setAttribute("md-min-length",r),a&&t.setAttribute("md-max-length",a),n&&t.setAttribute("md-floating-label",n))}function u(e){var t=e.fieldFrag.querySelector("md-switch");e.form.schema.titleMap&&(t.setAttribute("ng-true-value",e.form.schema.titleMap.true),t.setAttribute("ng-false-value",e.form.schema.titleMap.false))}function h(e){var t,r,r=e.fieldFrag.querySelector("md-select");if(e.form.selectOptions=[],e.form.getOptions=n,e.form.schema&&e.form.schema.links&&"object"==typeof e.form.schema.links){var a,i=/({)([^}]*)(})/gm;for(t=0;t<e.form.schema.links.length;t++)a=e.form.schema.links[t],"options"===a.rel&&(e.form.optionSource=a.href.replace(i,"$1$1 model.$2 $3$3"));r.setAttribute("sfm-external-options",e.form.optionSource)}else e.form.selectOptions=o(e.form)}function v(e){var t=e.fieldFrag.querySelector("md-datepicker");if(t){e.form.onChange&&t.setAttribute("ng-change","args.form.onChange(searchText)");var r=e.form.minimum||!1,a=e.form.maximum||!1;r&&t.setAttribute("md-max-date",r),a&&t.setAttribute("md-max-date",a)}}function b(e){if(e.form.tabs&&e.form.tabs.length>0){var t=e.fieldFrag.querySelector("md-tabs");e.form.tabs.forEach(function(r,a){var n="(evalExpr("+e.path+".tabs["+a+'].condition, { model: model, "arrayIndex": $index}))',o=document.createElement("md-tab");r.condition&&o.setAttribute("ng-if",n),o.setAttribute("label","{{"+e.path+".tabs["+a+"].title}}");var i=document.createElement("md-tab-body"),l=e.build(r.items,e.path+".tabs["+a+"].items",e.state);i.appendChild(l),o.appendChild(i),t.appendChild(o)})}}function x(t,r,n){if("string"===r.type&&("date"===r.format||"date-time"===r.format)){var o=e.stdFormObj(t,r,n);return o.key=n.path,o.type="date",n.lookup[a.stringify(n.path)]=o,o}}var M=r.builders.simpleTransclusion,C=r.builders.ngModelOptions,F=r.builders.ngModel,O=r.builders.sfField,S=r.builders.condition,P=r.builders.array,j=r.builders.numeric,l=l,I=function(){var e=document.createElement("div");return e.innerHTML='<div ng-if="ngModel.$invalid" ng-messages="ngModel.$error"><div sf-message ng-message></div></div>',e.firstChild}(),L=s,R=h,z=f,_=u,W=v,G=b,J=m,Z=[O,F,C,S,l],Q=Z.concat(L),X=Z.concat(P);e.defaults.string.unshift(x),t.defineDecorator("materialDecorator",{actions:{template:c.a,builder:[O,M,S]},array:{template:d.a,builder:X},autocomplete:{template:p.a,builder:Q.concat(z)},boolean:{template:g.a,builder:Q},button:{template:y.a,builder:Q},checkbox:{template:g.a,builder:Q},checkboxes:{template:$.a,builder:X},date:{template:k.a,builder:Q.concat(W)},default:{template:w.a,builder:Q},fieldset:{template:A.a,builder:[O,M,S]},help:{template:E.a,builder:Q},number:{template:w.a,builder:Q.concat(j)},password:{template:w.a,builder:Q},radios:{template:V.a,builder:Q},"radios-inline":{template:D.a,builder:Q},radiobuttons:{template:T.a,builder:Q},section:{template:q.a,builder:[O,M,S,l]},select:{template:N.a,builder:Q.concat(R)},submit:{template:y.a,builder:Q},tabs:{template:H.a,builder:[O,G,S]},tabarray:{template:U.a,builder:X},textarea:{template:B.a,builder:Q.concat(J)},switch:{template:K.a,builder:Q.concat(_)}})}function n(e,t){return e.optionData?t(e.optionData):e.selectOptions?e.selectOptions:[]}function o(e){var t=[];if(e.titleMap)return e.titleMap;if(e.enum&&e.enum.length)for(i=0;i<e.enum.length;i++)e.enum[i]&&e.enum[i].length&&t.push({name:e.enum[i],value:e.enum[i]});return t}function l(e){function t(t,r,a){a.$observe("sfmExternalOptions",function(r){e.get(r).then(function(e){t.form.selectOptions=o(e.data)})})}return{link:t,restrict:"A"}}function s(){return function(e){if(!e)return"";var t,r,a;for(a=e.slice(),r=0;r<a.length;r++)t=a[r].toLowerCase().split(""),r&&t.length&&(t[0]=t[0].toUpperCase()),a[r]=t.join("");return a.join("")}}Object.defineProperty(t,"__esModule",{value:!0});var m=r(4),c=r.n(m),f=r(5),d=r.n(f),u=r(6),p=r.n(u),h=r(1),g=r.n(h),v=r(2),y=r.n(v),b=r(7),$=r.n(b),x=r(8),k=r.n(x),M=r(0),w=r.n(M),C=r(9),A=r.n(C),F=r(10),E=r.n(F),O=r(13),V=r.n(O),S=r(12),D=r.n(S),P=r(11),T=r.n(P),j=r(14),q=r.n(j),I=r(15),N=r.n(I),L=r(16),K=r.n(L),R=r(18),H=r.n(R),z=r(17),U=r.n(z),_=r(19),B=r.n(_);angular.module("schemaForm").config(a).directive("sfmExternalOptions",l).filter("sfCamelKey",s),a.$inject=["schemaFormProvider","schemaFormDecoratorsProvider","sfBuilderProvider","sfPathProvider","$injector"],l.$inject=["$http"]},function(e,t){angular.module("schemaForm").directive("sfTypeParser",function(){return{restrict:"A",scope:!1,require:"ngModel",link:function(e,t,r,a){var n=e.$watch(r.sfTypeParser,function(e){if(e){var t=-1!==e.type.indexOf("number"),r=-1!==e.type.indexOf("integer"),o=/^[0-9]*$/;(t||r)&&a.$parsers.push(function(e){var r;return t?r=parseFloat(e):o.test(e)&&(r=parseInt(e,10)),console.log("parser",o.test(e),e,r),void 0===r||isNaN(r)?e:r}),n()}})}}})},function(e,t,r){var a,n,o;!function(i,l){n=[r(26),r(24),r(27)],a=l,void 0!==(o="function"==typeof a?a.apply(t,n):a)&&(e.exports=o)}(0,function(e,t,r){var a=[];try{e.module("ngSanitize"),a.push("ngSanitize")}catch(e){}try{e.module("ui.sortable"),a.push("ui.sortable")}catch(e){}try{e.module("angularSpectrumColorpicker"),a.push("angularSpectrumColorpicker")}catch(e){}var n=e.module("schemaForm",a);return e.module("schemaForm").provider("sfPath",[function(){var r=window.ObjectPath||t,a={parse:r.parse};1===e.version.major&&e.version.minor<3?a.stringify=function(e){return Array.isArray(e)?e.join("."):e.toString()}:a.stringify=r.stringify,a.normalize=function(e,t){return a.stringify(Array.isArray(e)?e:a.parse(e),t)},this.parse=a.parse,this.stringify=a.stringify,this.normalize=a.normalize,this.$get=function(){return a}}]),e.module("schemaForm").provider("sfBuilder",["sfPathProvider",function(t){var r=/[A-Z]/g,a=function(e,t){return t=t||"_",e.replace(r,function(e,r){return(r?t:"")+e.toLowerCase()})},n=0,o={sfField:function(e){e.fieldFrag.firstChild.setAttribute("sf-field",n),e.lookup["f"+n]=e.form,n++},ngModel:function(e){if(e.form.key){var r=e.form.key;e.state.keyRedaction&&(r=r.slice(e.state.keyRedaction));var a;if(e.state.modelValue)a=e.state.modelValue;else{var n=t.stringify(r).replace(/"/g,"&quot;");a=e.state.modelName||"model",n&&(a+=("["!==n[0]?".":"")+n)}for(var o=e.fieldFrag.querySelectorAll("[sf-field-model]"),i=0;i<o.length;i++){var l=o[i],s=l.getAttribute("sf-field-model");if(s&&""!==s)if("replaceAll"===s)for(var m=l.attributes,c=0;c<m.length;c++)m[c].value&&-1!==m[c].value.indexOf("$$value")&&(m[c].value=m[c].value.replace(/\$\$value\$\$/g,a));else{var f=l.getAttribute(s);f&&f.indexOf("$$value$$")?l.setAttribute(s,f.replace(/\$\$value\$\$/g,a)):l.setAttribute(s,a)}else l.setAttribute("ng-model",a)}}},simpleTransclusion:function(e){var t=e.build(e.form.items,e.path+".items",e.state);e.fieldFrag.firstChild.appendChild(t)},ngModelOptions:function(e){e.form.ngModelOptions&&Object.keys(e.form.ngModelOptions).length>0&&e.fieldFrag.firstChild.setAttribute("ng-model-options",JSON.stringify(e.form.ngModelOptions))},transclusion:function(e){var t=e.fieldFrag.querySelectorAll("[sf-field-transclude]");if(t.length)for(var r=0;r<t.length;r++){var a=t[r],n=a.getAttribute("sf-field-transclude")||"items",o=e.form[n];if(o){var i=e.build(o,e.path+"."+n,e.state);a.appendChild(i)}}},condition:function(e){if(e.form.condition){var r="evalExpr("+e.path+'.condition, { model: model, "arrayIndex": $index})';if(e.form.key){var a=t.stringify(e.form.key);r="evalExpr("+e.path+'.condition,{ model: model, "arrayIndex": $index, "modelValue": model'+("["===a[0]?"":".")+a+"})"}for(var n=e.fieldFrag.children||e.fieldFrag.childNodes,o=0;o<n.length;o++){var i=n[o],l=i.getAttribute("ng-if");i.setAttribute("ng-if",l?"("+l+") || ("+r+")":r)}}},array:function(r){var a=r.fieldFrag.querySelector("[schema-form-array-items]");if(a){state=e.copy(r.state),state.keyRedaction=state.keyRedaction||0,state.keyRedaction+=r.form.key.length+1,r.form.schema&&r.form.schema.items&&r.form.schema.items.type&&-1===r.form.schema.items.type.indexOf("object")&&-1===r.form.schema.items.type.indexOf("array")?(t.stringify(r.form.key).replace(/"/g,"&quot;"),state.modelValue="modelArray[$index]"):state.modelName="item",state.arrayCompatFlag=!0;var n=r.build(r.form.items,r.path+".items",state);a.appendChild(n)}}};this.builders=o;var i=[o.sfField,o.ngModel,o.ngModelOptions,o.condition];this.stdBuilders=i,this.$get=["$templateCache","schemaFormDecorators","sfPath",function(e,t,r){var n=function(e,t){if(e.key){var a=t[r.stringify(e.key)];if(a){for(;a.firstChild;)a.removeChild(a.firstChild);return a}}},l=function(e,t,r,o,i,s,m){s=s||{},m=m||Object.create(null),i=i||"schemaForm.form";var c=document.createDocumentFragment();return e.reduce(function(e,c,f){if(!c.type)return e;var d=t[c.type]||t.default;if(d.replace){var u;s.arrayCompatFlag=!1;var p=document.createElement("div"),h=r(c,d)||r(c,t.default);for(p.innerHTML=h,u=document.createDocumentFragment();p.childNodes.length>0;)u.appendChild(p.childNodes[0]);var g={fieldFrag:u,form:c,lookup:m,state:s,path:i+"["+f+"]",build:function(e,a,n){return l(e,t,r,o,a,n,m)}},v=c.builder||d.builder;"function"==typeof v?v(g):v.forEach(function(e){e(g)}),(n(c,o)||e).appendChild(u)}else{var y=document.createElement(a(t.__name,"-"));s.arrayCompatFlag?y.setAttribute("form","copyWithIndex($index)"):y.setAttribute("form",i+"["+f+"]"),(n(c,o)||e).appendChild(y)}return e},c),c};return{build:function(t,r,a,n){return l(t,r,function(t,r){return"template"===t.type?t.template:e.get(r.template)},a,void 0,void 0,n)},builder:o,stdBuilders:i,internalBuild:l}}]}]),e.module("schemaForm").provider("schemaFormDecorators",["$compileProvider","sfPathProvider",function(t,r){var a="",n={},o=function(e,t){"sfDecorator"===e&&(e=a);var r=n[e];return r[t.type]?r[t.type].template:r.default.template},i=function(a){t.directive(a,["$parse","$compile","$http","$templateCache","$interpolate","$q","sfErrorMessage","sfPath","sfSelect",function(t,n,i,l,s,m,c,f,d){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"?^sfSchema",link:function(t,u,p,h){t.$on("schemaFormPropagateNgModelController",function(e,r){e.stopPropagation(),e.preventDefault(),t.ngModel=r}),t.showTitle=function(){return t.form&&!0!==t.form.notitle&&t.form.title},t.listToCheckboxValues=function(t){var r={};return e.forEach(t,function(e){r[e]=!0}),r},t.checkboxValuesToList=function(t){var r=[];return e.forEach(t,function(e,t){e&&r.push(t)}),r},t.buttonClick=function(r,a){e.isFunction(a.onClick)?a.onClick(r,a):e.isString(a.onClick)&&(h?h.evalInParentScope(a.onClick,{$event:r,form:a}):t.$eval(a.onClick,{$event:r,form:a}))},t.evalExpr=function(e,r){return h?h.evalInParentScope(e,r):t.$eval(e,r)},t.evalInScope=function(e,r){return e?t.$eval(e,r):void 0},t.interp=function(e,t){return e&&s(e)(t)},t.hasSuccess=function(){return!!t.ngModel&&(t.ngModel.$valid&&(!t.ngModel.$pristine||!t.ngModel.$isEmpty(t.ngModel.$modelValue)))},t.hasError=function(){return!!t.ngModel&&(t.ngModel.$invalid&&!t.ngModel.$pristine)},t.errorMessage=function(e){return c.interpolate(e&&e.code+""||"default",t.ngModel&&t.ngModel.$modelValue||"",t.ngModel&&t.ngModel.$viewValue||"",t.form,t.options&&t.options.validationMessage)};var g=t.$watch(p.form,function(s){if(s){s.ngModelOptions=s.ngModelOptions||{},t.form=s;var c;if("template"===s.type&&s.template)c=m.when(s.template);else{var p="template"===s.type?s.templateUrl:o(a,s);c=i.get(p,{cache:l}).then(function(e){return e.data})}c.then(function(a){if(s.key){var o=s.key?r.stringify(s.key).replace(/"/g,"&quot;"):"";a=a.replace(/\$\$value\$\$/g,"model"+("["!==o[0]?".":"")+o)}if(u.html(a),s.condition){var i='evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex})';s.key&&(i='evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex, "modelValue": model'+f.stringify(s.key)+"})"),e.forEach(u.children(),function(e){var t=e.getAttribute("ng-if");e.setAttribute("ng-if",t?"("+t+") || ("+i+")":i)})}n(u.contents())(t)}),s.key&&(t.$on("schemaForm.error."+s.key.join("."),function(e,r,a,n){(!0===a||!1===a)&&(n=a,a=void 0),t.ngModel&&r&&(t.ngModel.$setDirty?t.ngModel.$setDirty():(t.ngModel.$dirty=!0,t.ngModel.$pristine=!1),a&&(s.validationMessage||(s.validationMessage={}),s.validationMessage[r]=a),t.ngModel.$setValidity(r,!0===n),!0===n&&(t.ngModel.$validate(),t.$broadcast("schemaFormValidate")))}),t.$on("$destroy",function(){if(!t.externalDestructionInProgress){var e=s.destroyStrategy||t.options&&t.options.destroyStrategy||"remove";if(s.key&&"retain"!==e){var r=t.model;if(s.key.length>1&&(r=d(s.key.slice(0,s.key.length-1),r)),void 0===r)return;var a=s.schema&&s.schema.type||"";"empty"===e&&-1!==a.indexOf("string")?r[s.key.slice(-1)]="":"empty"===e&&-1!==a.indexOf("object")?r[s.key.slice(-1)]={}:"empty"===e&&-1!==a.indexOf("array")?r[s.key.slice(-1)]=[]:"null"===e?r[s.key.slice(-1)]=null:delete r[s.key.slice(-1)]}}})),g()}})}}}])},l=function(r,a,n){n=!!e.isDefined(n)&&n,t.directive("sf"+e.uppercase(r[0])+r.substr(1),function(){return{restrict:"EAC",scope:!0,replace:!0,transclude:n,template:'<sf-decorator form="form"></sf-decorator>',link:function(t,a,n){var o={items:"c",titleMap:"c",schema:"c"},i={type:r},l=!0;e.forEach(n,function(r,a){if("$"!==a[0]&&0!==a.indexOf("ng")&&"sfField"!==a){var s=function(r){e.isDefined(r)&&r!==i[a]&&(i[a]=r,l&&i.type&&(i.key||e.isUndefined(n.key))&&(t.form=i,l=!1))};"model"===a?t.$watch(r,function(e){e&&t.model!==e&&(t.model=e)}):"c"===o[a]?t.$watchCollection(r,s):n.$observe(a,s)}})}}})};this.createDecorator=function(t,r){n[t]={__name:t},e.forEach(r,function(e,r){n[t][r]={template:e,replace:!1,builder:[]}}),n[a]||(a=t),i(t)},this.defineDecorator=function(t,r){n[t]={__name:t},e.forEach(r,function(r,a){r.builder=r.builder||[],r.replace=!e.isDefined(r.replace)||r.replace,n[t][a]=r}),n[a]||(a=t),i(t)},this.createDirective=l,this.createDirectives=function(t){e.forEach(t,function(e,t){l(t)})},this.decorator=function(e){return e=e||a,n[e]},this.addMapping=function(e,t,r,a,o){n[e]&&(n[e][t]={template:r,builder:a,replace:!!o})},this.defineAddOn=function(e,t,r,a){n[e]&&(n[e][t]={template:r,builder:a,replace:!0})},this.$get=function(){return{decorator:function(e){return n[e]||n[a]},defaultDecorator:a}},i("sfDecorator")}]),e.module("schemaForm").provider("sfErrorMessage",function(){var t={default:"Field does not validate",0:"Invalid type, expected {{schema.type}}",1:"No enum match for: {{viewValue}}",10:'Data does not match any schemas from "anyOf"',11:'Data does not match any schemas from "oneOf"',12:'Data is valid against more than one schema from "oneOf"',13:'Data matches schema from "not"',100:"Value is not a multiple of {{schema.multipleOf}}",101:"{{viewValue}} is less than the allowed minimum of {{schema.minimum}}",102:"{{viewValue}} is equal to the exclusive minimum {{schema.minimum}}",103:"{{viewValue}} is greater than the allowed maximum of {{schema.maximum}}",104:"{{viewValue}} is equal to the exclusive maximum {{schema.maximum}}",105:"Value is not a valid number",200:"String is too short ({{viewValue.length}} chars), minimum {{schema.minLength}}",201:"String is too long ({{viewValue.length}} chars), maximum {{schema.maxLength}}",202:"String does not match pattern: {{schema.pattern}}",300:"Too few properties defined, minimum {{schema.minProperties}}",301:"Too many properties defined, maximum {{schema.maxProperties}}",302:"Required",303:"Additional properties not allowed",304:"Dependency failed - key must exist",400:"Array is too short ({{value.length}}), minimum {{schema.minItems}}",401:"Array is too long ({{value.length}}), maximum {{schema.maxItems}}",402:"Array items are not unique",403:"Additional items not allowed",500:"Format validation failed",501:'Keyword failed: "{{title}}"',600:"Circular $refs",1e3:"Unknown property (not in schema)"};t.number=t[105],t.required=t[302],t.min=t[101],t.max=t[103],t.maxlength=t[201],t.minlength=t[200],t.pattern=t[202],this.setDefaultMessages=function(e){t=e},this.getDefaultMessages=function(){return t},this.setDefaultMessage=function(e,r){t[e]=r},this.$get=["$interpolate",function(r){var a={};return a.defaultMessages=t,a.interpolate=function(a,n,o,i,l){l=l||{};var s=i.validationMessage||{};0===a.indexOf("tv4-")&&(a=a.substring(4));var m=s.default||l.default||"";[s,l,t].some(function(t){return e.isString(t)||e.isFunction(t)?(m=t,!0):t&&t[a]?(m=t[a],!0):void 0});var c={error:a,value:n,viewValue:o,form:i,schema:i.schema,title:i.title||i.schema&&i.schema.title};return e.isFunction(m)?m(c):r(m)(c)},a}]}),e.module("schemaForm").provider("schemaForm",["sfPathProvider",function(t){var r=function(e){if(Array.isArray(e)&&2==e.length){if("null"===e[0])return e[1];if("null"===e[1])return e[0]}return e},a=function(e){var t=[];return e.forEach(function(e){t.push({name:e,value:e})}),t},n=function(t,r){if(!e.isArray(t)){var a=[];return r?e.forEach(r,function(e,r){a.push({name:t[e],value:e})}):e.forEach(t,function(e,t){a.push({name:e,value:t})}),a}return t},o=function(t,a,n){var o=h[r(a.type)];if(o)for(var i,l=0;l<o.length;l++)if(i=o[l](t,a,n))return i.schema["x-schema-form"]&&e.isObject(i.schema["x-schema-form"])&&(i=e.extend(i,i.schema["x-schema-form"])),i},i=function(t,r,a){a=a||{};var o=a.global&&a.global.formDefaults?e.copy(a.global.formDefaults):{};return a.global&&!0===a.global.supressPropertyTitles?o.title=r.title:o.title=r.title||t,r.description&&(o.description=r.description),(!0===a.required||!0===r.required)&&(o.required=!0),r.maxLength&&(o.maxlength=r.maxLength),r.minLength&&(o.minlength=r.minLength),(r.readOnly||r.readonly)&&(o.readonly=!0),r.minimum&&(o.minimum=r.minimum+(r.exclusiveMinimum?1:0)),r.maximum&&(o.maximum=r.maximum-(r.exclusiveMaximum?1:0)),r.validationMessage&&(o.validationMessage=r.validationMessage),r.enumNames&&(o.titleMap=n(r.enumNames,r.enum)),o.schema=r,o.ngModelOptions=o.ngModelOptions||{},o},l=function(e,a,n){if("string"===r(a.type)&&!a.enum){var o=i(e,a,n);return o.key=n.path,o.type="text",n.lookup[t.stringify(n.path)]=o,o}},s=function(e,a,n){if("number"===r(a.type)){var o=i(e,a,n);return o.key=n.path,o.type="number",n.lookup[t.stringify(n.path)]=o,o}},m=function(e,a,n){if("integer"===r(a.type)){var o=i(e,a,n);return o.key=n.path,o.type="number",n.lookup[t.stringify(n.path)]=o,o}},c=function(e,a,n){if("boolean"===r(a.type)){var o=i(e,a,n);return o.key=n.path,o.type="checkbox",n.lookup[t.stringify(n.path)]=o,o}},f=function(e,n,o){if("string"===r(n.type)&&n.enum){var l=i(e,n,o);return l.key=o.path,l.type="select",l.titleMap||(l.titleMap=a(n.enum)),o.lookup[t.stringify(o.path)]=l,l}},d=function(e,n,o){if("array"===r(n.type)&&n.items&&n.items.enum){var l=i(e,n,o);return l.key=o.path,l.type="checkboxes",l.titleMap||(l.titleMap=a(n.items.enum)),o.lookup[t.stringify(o.path)]=l,l}},u=function(a,n,l){if("object"===r(n.type)){var s=i(a,n,l);return s.type="fieldset",s.items=[],l.lookup[t.stringify(l.path)]=s,e.forEach(n.properties,function(e,r){var a=l.path.slice();if(a.push(r),!0!==l.ignore[t.stringify(a)]){var i=n.required&&-1!==n.required.indexOf(r),m=o(r,e,{path:a,required:i||!1,lookup:l.lookup,ignore:l.ignore,global:l.global});m&&s.items.push(m)}}),s}},p=function(e,a,n){if("array"===r(a.type)){var l=i(e,a,n);l.type="array",l.key=n.path,n.lookup[t.stringify(n.path)]=l;var s=a.required&&-1!==a.required.indexOf(n.path[n.path.length-1]),m=n.path.slice();return m.push(""),l.items=[o(e,a.items,{path:m,required:s||!1,lookup:n.lookup,ignore:n.ignore,global:n.global})],l}},h={string:[f,l],object:[u],number:[s],integer:[m],boolean:[c],array:[d,p]},g=function(e){return e};this.defaults=h,this.stdFormObj=i,this.defaultFormDefinition=o,this.postProcess=function(e){g=e},this.appendRule=function(e,t){h[e]||(h[e]=[]),h[e].push(t)},this.prependRule=function(e,t){h[e]||(h[e]=[]),h[e].unshift(t)},this.createStandardForm=i,this.$get=function(){var a={};return a.merge=function(r,o,i,l,s,m){o=o||["*"],l=l||{},s=s||r.readonly||r.readOnly;var c=a.defaults(r,i,l),f=o.indexOf("*");-1!==f&&(o=o.slice(0,f).concat(c.form).concat(o.slice(f+1)));var d=c.lookup;return g(o.map(function(o){if("string"==typeof o&&(o={key:o}),o.key&&"string"==typeof o.key&&(o.key=t.parse(o.key)),o.titleMap&&(o.titleMap=n(o.titleMap)),o.itemForm){o.items=[];var c=t.stringify(o.key),f=d[c];e.forEach(f.items,function(t){var r=e.copy(o.itemForm);r.key=t.key,o.items.push(r)})}if(o.key){var u=t.stringify(o.key);if(d[u]){var p=d[u];e.forEach(p,function(e,t){void 0===o[t]&&(o[t]=p[t])})}}return!0===s&&(o.readonly=!0),o.items&&(o.items=a.merge(r,o.items,i,l,o.readonly,m)),o.tabs&&e.forEach(o.tabs,function(e){e.items=a.merge(r,e.items,i,l,o.readonly,m)}),"checkbox"===o.type&&e.isUndefined(o.schema.default)&&(o.schema.default=!1),m&&"template"===o.type&&!o.template&&o.templateUrl&&m.push(o),o}))},a.defaults=function(t,a,n){var i=[],l={};if(a=a||{},n=n||{},"object"!==r(t.type))throw new Error('Not implemented. Only type "object" allowed at root level of schema.');return e.forEach(t.properties,function(e,r){if(!0!==a[r]){var s=t.required&&-1!==t.required.indexOf(r),m=o(r,e,{path:[r],lookup:l,ignore:a,required:s,global:n});m&&i.push(m)}}),{form:i,lookup:l}},a.traverseSchema=function(t,r,a,n){n=!e.isDefined(n)||n,a=a||[];var o=function(t,r,a){if(r(t,a),e.forEach(t.properties,function(e,t){var n=a.slice();n.push(t),o(e,r,n)}),!n&&t.items){var i=a.slice();i.push(""),o(t.items,r,i)}};o(t,r,a||[])},a.traverseForm=function(t,r){r(t),e.forEach(t.items,function(e){a.traverseForm(e,r)}),t.tabs&&e.forEach(t.tabs,function(t){e.forEach(t.items,function(e){a.traverseForm(e,r)})})},a}}]),e.module("schemaForm").factory("sfSelect",["sfPath",function(e){var t=/^\d+$/;return function(r,a,n){a||(a=this);var o="string"==typeof r?e.parse(r):r;if(void 0!==n&&1===o.length)return a[o[0]]=n,a;void 0!==n&&void 0===a[o[0]]&&(a[o[0]]=o.length>2&&t.test(o[1])?[]:{});for(var i=a[o[0]],l=1;l<o.length;l++){if(""===o[l])return;if(void 0!==n){if(l===o.length-1)return i[o[l]]=n,n;var s=i[o[l]];(void 0===s||null===s)&&(s=t.test(o[l+1])?[]:{},i[o[l]]=s),i=s}else i&&(i=i[o[l]])}return i}}]),e.module("schemaForm").factory("sfValidator",[function(){var t={};return t.validate=function(t,a){if(!t)return{valid:!0};var n=t.schema;if(!n)return{valid:!0};""===a&&(a=void 0),"number"===t.type&&null===a&&(a=void 0);var o={type:"object",properties:{}},i=t.key[t.key.length-1];o.properties[i]=n,t.required&&(o.required=[i]);var l={};return e.isDefined(a)&&(l[i]=a),r.validateResult(l,o)},t}]),e.module("schemaForm").directive("sfArray",["sfSelect","schemaForm","sfValidator","sfPath",function(t,r,a,n){var o=function(e){return function(t){t.key&&(t.key[t.key.indexOf("")]=e)}};return{restrict:"A",scope:!0,require:"?ngModel",link:function(i,l,s,m){var c={};i.validateArray=e.noop,m&&i.$emit("schemaFormPropagateNgModelController",m);var f=i.$watch(s.sfArray,function(l){if(l){var s=t(l.key,i.model),d=n.normalize(l.key);if(i.$watch("model"+("["!==d[0]?".":"")+d,function(e){s=i.modelArray=e}),e.isUndefined(s)&&(s=[],t(l.key,i.model,s)),i.modelArray=s,l.items){var u=l.items[0];l.items.length>1&&(u={type:"section",items:l.items.map(function(t){return t.ngModelOptions=l.ngModelOptions,e.isUndefined(t.readonly)&&(t.readonly=l.readonly),t})})}if(i.copyWithIndex=function(t){if(!c[t]&&u){var a=e.copy(u);a.arrayIndex=t,r.traverseForm(a,o(t)),c[t]=a}return c[t]},i.appendToArray=function(){var a=s.length,n=i.copyWithIndex(a);if(r.traverseForm(n,function(r){if(r.key){var a;e.isDefined(r.default)&&(a=r.default),e.isDefined(r.schema)&&e.isDefined(r.schema.default)&&(a=r.schema.default),e.isDefined(a)&&t(r.key,i.model,a)}}),a===s.length){var o,m=t("schema.items.type",l);"object"===m?o={}:"array"===m&&(o=[]),s.push(o)}return i.validateArray(),s},i.deleteFromArray=function(e){return s.splice(e,1),i.validateArray(),m&&m.$setDirty&&m.$setDirty(),s},l.titleMap||!0===l.startEmpty||0!==s.length||i.appendToArray(),l.titleMap&&l.titleMap.length>0){i.titleMapValues=[];var p=function(e){i.titleMapValues=[],e=e||[],l.titleMap.forEach(function(t){i.titleMapValues.push(-1!==e.indexOf(t.value))})};p(i.modelArray),i.$watchCollection("modelArray",p),i.$watchCollection("titleMapValues",function(e,t){if(e&&e!==t){for(var r=i.modelArray;r.length>0;)r.pop();l.titleMap.forEach(function(t,a){e[a]&&r.push(t.value)}),i.validateArray()}})}if(m){var h;i.validateArray=function(){var e=a.validate(l,i.modelArray.length>0?i.modelArray:void 0);Object.keys(m.$error).filter(function(e){return 0===e.indexOf("tv4-")}).forEach(function(e){m.$setValidity(e,!0)}),!1!==e.valid||!e.error||""!==e.error.dataPath&&e.error.dataPath!=="/"+l.key[l.key.length-1]||(m.$setViewValue(i.modelArray),h=e.error,m.$setValidity("tv4-"+e.error.code,!1))},i.$on("schemaFormValidate",i.validateArray),i.hasSuccess=function(){return i.options&&i.options.pristine&&!1===i.options.pristine.success?m.$valid&&!m.$pristine&&!m.$isEmpty(m.$modelValue):m.$valid&&(!m.$pristine||!m.$isEmpty(m.$modelValue))},i.hasError=function(){return i.options&&i.options.pristine&&!1===i.options.pristine.errors?m.$invalid&&!m.$pristine:m.$invalid},i.schemaError=function(){return h}}f()}})}}}]),e.module("schemaForm").directive("sfChanged",function(){return{require:"ngModel",restrict:"AC",scope:!1,link:function(t,r,a,n){var o=t.$eval(a.sfChanged);o&&o.onChange&&n.$viewChangeListeners.push(function(){e.isFunction(o.onChange)?o.onChange(n.$modelValue,o):t.evalExpr(o.onChange,{modelValue:n.$modelValue,form:o})})}}}),e.module("schemaForm").directive("sfField",["$parse","$compile","$http","$templateCache","$interpolate","$q","sfErrorMessage","sfPath","sfSelect",function(t,r,a,n,o,i,l,s,m){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"^sfSchema",link:{pre:function(e,t,r,a){e.$on("schemaFormPropagateNgModelController",function(t,r){t.stopPropagation(),t.preventDefault(),e.ngModel=r}),e.form=a.lookup["f"+r.sfField]},post:function(t,r,a,n){t.showTitle=function(){return t.form&&!0!==t.form.notitle&&t.form.title},t.listToCheckboxValues=function(t){var r={};return e.forEach(t,function(e){r[e]=!0}),r},t.checkboxValuesToList=function(t){var r=[];return e.forEach(t,function(e,t){e&&r.push(t)}),r},t.buttonClick=function(r,a){e.isFunction(a.onClick)?a.onClick(r,a):e.isString(a.onClick)&&(n?n.evalInParentScope(a.onClick,{$event:r,form:a}):t.$eval(a.onClick,{$event:r,form:a}))},t.evalExpr=function(e,r){return n?n.evalInParentScope(e,r):t.$eval(e,r)},t.evalInScope=function(e,r){return e?t.$eval(e,r):void 0},t.interp=function(e,t){return e&&o(e)(t)},t.hasSuccess=function(){return!!t.ngModel&&(t.options&&t.options.pristine&&!1===t.options.pristine.success?t.ngModel.$valid&&!t.ngModel.$pristine&&!t.ngModel.$isEmpty(t.ngModel.$modelValue):t.ngModel.$valid&&(!t.ngModel.$pristine||!t.ngModel.$isEmpty(t.ngModel.$modelValue)))},t.hasError=function(){return!!t.ngModel&&(t.options&&t.options.pristine&&!1===t.options.pristine.errors?t.ngModel.$invalid&&!t.ngModel.$pristine:t.ngModel.$invalid)},t.errorMessage=function(e){return l.interpolate(e&&e.code+""||"default",t.ngModel&&t.ngModel.$modelValue||"",t.ngModel&&t.ngModel.$viewValue||"",t.form,t.options&&t.options.validationMessage)};var i=t.form;i.key&&(t.$on("schemaForm.error."+i.key.join("."),function(e,r,a,n){(!0===a||!1===a)&&(n=a,a=void 0),t.ngModel&&r&&(t.ngModel.$setDirty?t.ngModel.$setDirty():(t.ngModel.$dirty=!0,t.ngModel.$pristine=!1),a&&(i.validationMessage||(i.validationMessage={}),i.validationMessage[r]=a),t.ngModel.$setValidity(r,!0===n),!0===n&&(t.ngModel.$validate(),t.$broadcast("schemaFormValidate")))}),t.$on("$destroy",function(){if(!t.externalDestructionInProgress){var e=i.destroyStrategy||t.options&&t.options.destroyStrategy||"remove";if(i.key&&"retain"!==e){var r=t.model;if(i.key.length>1&&(r=m(i.key.slice(0,i.key.length-1),r)),void 0===r)return;var a=i.schema&&i.schema.type||"";"empty"===e&&-1!==a.indexOf("string")?r[i.key.slice(-1)]="":"empty"===e&&-1!==a.indexOf("object")?r[i.key.slice(-1)]={}:"empty"===e&&-1!==a.indexOf("array")?r[i.key.slice(-1)]=[]:"null"===e?r[i.key.slice(-1)]=null:delete r[i.key.slice(-1)]}}}))}}}}]),e.module("schemaForm").directive("sfMessage",["$injector","sfErrorMessage",function(t,r){var a=t.has("$sanitize")?t.get("$sanitize"):function(e){return e};return{scope:!1,restrict:"EA",link:function(t,n,o){var i="";o.sfMessage&&t.$watch(o.sfMessage,function(e){e&&(i=a(e),m(!!t.ngModel))});var l,s=function(e){e!==l&&(n.html(e),l=e)},m=function(a){if(a)if(t.hasError()){var n=[];e.forEach(t.ngModel&&t.ngModel.$error,function(e,t){e&&n.push(t)}),n=n.filter(function(e){return"schemaForm"!==e});var o=n[0];s(o?r.interpolate(o,t.ngModel.$modelValue,t.ngModel.$viewValue,t.form,t.options&&t.options.validationMessage):i)}else s(i);else s(i)};m();var c=t.$watch("ngModel",function(e){e&&(e.$parsers.push(function(e){return m(!0),e}),e.$formatters.push(function(e){return m(!0),e}),c())});t.$watchCollection("ngModel.$error",function(){m(!!t.ngModel)})}}}]),e.module("schemaForm").directive("sfNewArray",["sfSelect","sfPath","schemaForm",function(t,r,a){return{scope:!1,link:function(n,o,i){n.min=0,n.modelArray=n.$eval(i.sfNewArray);var l=function(){n.modelArray=n.$eval(i.sfNewArray),(!(n.ngModel&&n.ngModel.$pristine&&n.firstDigest)||n.options&&!0===n.options.validateOnRender)&&n.validateField&&n.validateField()},s=function(){n.form&&n.form.onChange&&(e.isFunction(n.form.onChange)?n.form.onChange(n.modelArray,n.form):n.evalExpr(n.form.onChange,{modelValue:n.modelArray,form:n.form}))},m=function(){var e=n.modelArray;if(!e){var a=r.parse(i.sfNewArray);e=[],t(a,n,e),n.modelArray=e}return e},c=n.$watch("form",function(e){if(e){if(e.titleMap||!0===e.startEmpty||n.modelArray&&0!==n.modelArray.length||n.appendToArray(),n.form&&n.form.schema&&!0===n.form.schema.uniqueItems?(n.$watch(i.sfNewArray,l,!0),n.$watch([i.sfNewArray,i.sfNewArray+".length"],s)):n.$watchGroup?n.$watchGroup([i.sfNewArray,i.sfNewArray+".length"],function(){l(),s()}):(n.$watch(i.sfNewArray,function(){l(),s()}),n.$watch(i.sfNewArray+".length",function(){l(),s()})),e.titleMap&&e.titleMap.length>0){n.titleMapValues=[];var t=function(t){n.titleMapValues=[],t=t||[],e.titleMap.forEach(function(e){n.titleMapValues.push(-1!==t.indexOf(e.value))})};t(n.modelArray),n.$watchCollection("modelArray",t),n.$watchCollection("titleMapValues",function(t,r){if(t&&t!==r){for(var a=m();a.length>0;)a.pop();e.titleMap.forEach(function(e,r){t[r]&&a.push(e.value)}),n.validateField&&n.validateField()}})}c()}});n.appendToArray=function(){var r,o=m();if(n.form&&n.form.schema&&n.form.schema.items){var i=n.form.schema.items;i.type&&-1!==i.type.indexOf("object")?(r={},n.options&&!1===n.options.setSchemaDefaults||(r=e.isDefined(i.default)?i.default:r)&&a.traverseSchema(i,function(a,n){e.isDefined(a.default)&&t(n,r,a.default)})):i.type&&-1!==i.type.indexOf("array")?(r=[],n.options&&!1===n.options.setSchemaDefaults||(r=i.default||r)):n.options&&!1===n.options.setSchemaDefaults||(r=i.default||r)}return o.push(r),o},n.deleteFromArray=function(e){var t=n.modelArray;return t&&t.splice(e,1),t};var f=function(e){return function(t){t.key&&(t.key[t.key.indexOf("")]=e)}},d={};n.copyWithIndex=function(t){var r=n.form;if(!d[t]){var o=r.items[0];if(r.items.length>1&&(o={type:"section",items:r.items.map(function(t){return t.ngModelOptions=r.ngModelOptions,e.isUndefined(t.readonly)&&(t.readonly=r.readonly),t})}),o){var i=e.copy(o);i.arrayIndex=t,a.traverseForm(i,f(t)),d[t]=i}}return d[t]}}}}]),e.module("schemaForm").directive("sfSchema",["$compile","$http","$templateCache","$q","schemaForm","schemaFormDecorators","sfSelect","sfPath","sfBuilder",function(t,r,a,n,o,i,l,s,m){return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel",options:"=sfOptions"},controller:["$scope",function(e){this.evalInParentScope=function(t,r){return e.$parent.$eval(t,r)};var t=this;e.lookup=function(e){return e&&(t.lookup=e),t.lookup}}],replace:!1,restrict:"A",transclude:!0,require:"?form",link:function(s,c,f,d,u){s.formCtrl=d;var p={};u(s,function(e){if(e.addClass("schema-form-ignore"),c.prepend(e),c[0].querySelectorAll){var t=c[0].querySelectorAll("[ng-model]");if(t)for(var r=0;r<t.length;r++){var a=t[r].getAttribute("ng-model");p[a.substring(a.indexOf(".")+1)]=!0}}});var h,g={},v=function(e,t){var i=[],l=o.merge(e,t,p,s.options,void 0,i);i.length>0?n.all(i.map(function(e){return r.get(e.templateUrl,{cache:a}).then(function(t){e.template=t.data})})).then(function(){y(e,t,l)}):y(e,t,l)},y=function(r,a,n){h&&(s.externalDestructionInProgress=!0,h.$destroy(),s.externalDestructionInProgress=!1),h=s.$new(),h.schemaForm={form:n,schema:r},c.children(":not(.schema-form-ignore)").remove();for(var d={},u=c[0].querySelectorAll("*[sf-insert-field]"),p=0;p<u.length;p++)d[u[p].getAttribute("sf-insert-field")]=u[p];var g=i.decorator(f.sfUseDecorator),v=Object.create(null);s.lookup(v),c[0].appendChild(m.build(n,g,d,v)),h.firstDigest=!0,setTimeout(function(){h.firstDigest=!1},0),t(c.children())(h),s.options&&!1===s.options.setSchemaDefaults||o.traverseSchema(r,function(t,r){if(e.isDefined(t.default)){var a=l(r,s.model);e.isUndefined(a)&&l(r,s.model,t.default)}}),s.$emit("sf-render-finished",c)},b=["*"];s.$watch(function(){var e=s.schema,t=s.initialForm||b;t&&e&&e.type&&(g.form!==t||g.schema!==e)&&Object.keys(e.properties).length>0&&(g.schema=e,g.form=t,v(e,t))}),s.$on("schemaFormRedraw",function(){var t=s.schema,r=s.initialForm?e.copy(s.initialForm):["*"];t&&v(t,r)}),s.$on("$destroy",function(){s.externalDestructionInProgress=!0}),s.evalExpr=function(e,t){return s.$parent.$eval(e,t)}}}}]),e.module("schemaForm").directive("schemaValidate",["sfValidator","$parse","sfSelect",function(t,r,a){return{restrict:"A",scope:!1,priority:500,require:"ngModel",link:function(r,n,o,i){r.$emit("schemaFormPropagateNgModelController",i);var l=null,s=r.$eval(o.schemaValidate);s.copyValueTo&&i.$viewChangeListeners.push(function(){var t=s.copyValueTo;e.forEach(t,function(e){a(e,r.model,i.$modelValue)})});var m=function(e){if(!s)return e;if(r.options&&!1===r.options.tv4Validation)return e;var a=t.validate(s,e);return Object.keys(i.$error).filter(function(e){return 0===e.indexOf("tv4-")}).forEach(function(e){i.$setValidity(e,!0)}),a.valid?e:(i.$setValidity("tv4-"+a.error.code,!1),l=a.error,i.$validators?e:void 0)};"function"==typeof s.ngModel&&s.ngModel(i),["$parsers","$viewChangeListeners","$formatters"].forEach(function(e){s[e]&&i[e]&&s[e].forEach(function(t){i[e].push(t)})}),["$validators","$asyncValidators"].forEach(function(t){s[t]&&i[t]&&e.forEach(s[t],function(e,r){i[t][r]=e})}),i.$parsers.push(m),i.$validators&&(i.$validators.schemaForm=function(){return!Object.keys(i.$error).some(function(e){return"schemaForm"!==e})});var c=s.schema;r.validateField=function(e){(void 0==e||i.$$parentForm.$name===e)&&(c&&-1!==c.type.indexOf("array")&&m(i.$modelValue),i.$setDirty?(i.$setDirty(),i.$setViewValue(i.$viewValue),i.$commitViewValue(),s.required&&i.$isEmpty(i.$modelValue)&&i.$setValidity("tv4-302",!1)):i.$setViewValue(i.$viewValue))},i.$formatters.push(function(e){return!i.$pristine||!r.firstDigest||r.options&&!0===r.options.validateOnRender?(m(i.$modelValue),e):e}),r.$on("schemaFormValidate",function(e,t){r.validateField(t)}),r.schemaError=function(){return l}}}}]),n})},function(e,t,r){e.exports=r(25).ObjectPath},function(e,t,r){"use strict";var a;!function(n){var o={parse:function(e){if("string"!=typeof e)throw new TypeError("ObjectPath.parse must be passed a string");for(var t,r,a,n,o=0,i=[];o<e.length;)if(t=e.indexOf(".",o),r=e.indexOf("[",o),-1===t&&-1===r)i.push(e.slice(o,e.length)),o=e.length;else if(-1===r||-1!==t&&t<r)i.push(e.slice(o,t)),o=t+1;else if(r>o&&(i.push(e.slice(o,r)),o=r),'"'!==(a=e.slice(r+1,r+2))&&"'"!==a)n=e.indexOf("]",r),-1===n&&(n=e.length),i.push(e.slice(o+1,n)),o="."===e.slice(n+1,n+2)?n+2:n+1;else{for(n=e.indexOf(a+"]",r),-1===n&&(n=e.length);"\\"===e.slice(n-1,n)&&r<e.length;)r++,n=e.indexOf(a+"]",r);i.push(e.slice(o+2,n).replace(new RegExp("\\"+a,"g"),a)),o="."===e.slice(n+2,n+3)?n+3:n+2}return i},stringify:function(e,t){return Array.isArray(e)||(e=[e.toString()]),t='"'===t?'"':"'",e.map(function(e){return"["+t+e.toString().replace(new RegExp(t,"g"),"\\"+t)+t+"]"}).join("")},normalize:function(e,t){return o.stringify(Array.isArray(e)?e:o.parse(e),t)},registerModule:function(e){e.module("ObjectPath",[]).provider("ObjectPath",function(){this.parse=o.parse,this.stringify=o.stringify,this.normalize=o.normalize,this.$get=function(){return o}})}};void 0!==(a=function(){return{ObjectPath:o}}.call(t,r,t,e))&&(e.exports=a)}()},function(e,t){e.exports=angular},function(e,t){e.exports=tv4},,function(e,t,r){r(23),e.exports=r(3)}]);